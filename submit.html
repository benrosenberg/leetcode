<head>
    <meta id="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <title>LeetCode Solutions</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="icon" type="image/png" href="favicon.png">
  </head>

<div class="content">
    <div id="header">
        <h1 id="title" class="title">Submit a solution</h1>
        <span class="theme-toggle"><button class="theme-toggle-button" onclick="toggleColorMode();">toggle theme</button></span>
    </div>

    <h3 style="font-weight: 400;">by <a href="https://benrosenberg.info" class="link">Ben Rosenberg</a></h3>

    <p>
        Generate a submission data item to insert into the site's JSON file of submission data.
    </p>

    <div>
        <table cellpadding="4">
            <tr><td style="font-size: large;">Number</td><td><input type="text" id="problem-number"></td></tr>
            <tr><td style="font-size: large;">Title</td><td><input type="text" id="problem-title"></td></tr>
            <tr><td style="font-size: large;">Tags</td><td><input type="text" id="problem-tags"></td></tr>
            <tr><td style="font-size: large;">Difficulty</td><td><input type="text" id="problem-difficulty"></td></tr>
            <tr><td style="font-size: large;">Date</td><td><input type="date" id="problem-date"></td></tr>
            <tr><td style="font-size: large;">Language</td><td><input type="text" id="problem-language"></td></tr>
            <tr><td style="font-size: large;">Solution</td><td><textarea id="problem-solution" rows="20" cols="60"></textarea></td></tr>
        </table>
        <p>
            <button class="navbutton" onclick="generateSubmissionData();">Generate</button>
        </p>
    </div>

    <div>
        <pre><code id="output">Submit a problem solution to preview its JSON representation...</code></pre>
    </div>

    <div>
        <form onsubmit="sendViaWebhook(); return false;">
        <table cellpadding="4">
            <tr><td style="font-size: large;">Webhook URL</td><td><input type="password" id="webhook-url"></td></tr>
        </table>
        <p>
            <button class="navbutton" type="submit" onclick="">Update site data</button>
        </p>
        </form>
    </div>

    <p id="response-success" style="display: none"></p>

    <p>
        <a href="/" class="link">Return to problem set overview</a>
    </p>
</div>

<p class="bottom-text">Â© 2024-20XX <a href="https://benrosenberg.info" class="link">Ben Rosenberg</a></p>

<script>
    function sendViaWebhook() {
        webhookURL = document.getElementById('webhook-url').value;
        (async () => {
            try {
                var field = document.getElementById('output');
                var content = field.innerText;
                var text = { content: content };
                const response = await fetch(webhookURL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(text),
                });
                console.log("Completed!", response);
                var responseSuccess = document.getElementById('response-success');console.log('' + response.status);
                if (('' + response.status)[0] == '4') {
                    responseSuccess.innerText = `Failed with code ${response.status}. Your message is ${field.innerText.length} characters, which is above the max.`;
                    responseSuccess.style.color = 'red';
                } else {
                    responseSuccess.innerText = `Succeeded with code ${response.status}. Message has been sent to channel.`;
                    responseSuccess.style.color = 'green';
                }
                responseSuccess.style.display = 'initial';
            } catch (err) {
                console.error(`Error: ${err}`);
            }
        })();
    }

    function generateSubmissionData() {
        number = document.getElementById('problem-number').value;
        title = document.getElementById('problem-title').value;
        var tags = [];
        tagField = document.getElementById('problem-tags').value.split(',').map((tag) => tag.trim()).forEach(element => {
           if (element.length > 0) {
            tags.push(element);
           }
        });
        difficulty = document.getElementById('problem-difficulty').value;
        date = document.getElementById('problem-date').value;
        language = document.getElementById('problem-language').value;
        solution = document.getElementById('problem-solution').value;
        var data = {};
        data[number] = {
            "number" : number,
            "title" : title,
            "tags" : tags,
            "difficulty" : difficulty,
            "date" : date,
            "solution" : solution,
            "language" : language
        };
        output = document.getElementById('output');
        output.innerText = JSON.stringify(data, null, '    ');
    }
</script>

<script src="theme.js"></script>

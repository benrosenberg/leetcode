<head>
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, user-scalable=yes"
  />
  <title>LeetCode Solutions</title>
  <link rel="stylesheet" href="./style.css" />
  <link rel="icon" type="image/png" href="favicon.png" />
</head>

<div class="page">
  <div class="content">
    <div id="header">
      <h1 id="title" class="title">
        <a href="/" class="overview-title">LeetCode Solutions</a>
      </h1>
      <span class="theme-toggle"
        ><button class="theme-toggle-button" onclick="toggleColorMode();">
          toggle theme
        </button></span
      >
    </div>

    <h4 style="font-weight: 400">
      by
      <a class="link" href="https://benrosenberg.info">Ben Rosenberg</a>
      | <a class="link" href="about.html">About this site</a> |
      <a class="link" href="submit.html">Submit a solution</a>
    </h4>

    <h4 id="last-solved" class="date">Latest solved on</h4>

    <p id="total-solved">Total:</p>

    <p style="display: none" id="tag-filter">
      Filtering to problems tagged as:
    </p>
    
    <p style="display: none" id="difficulty-filter">
      Filtering to problems of difficulty:
    </p>

    <p style="display: none" id="language-filter">
      Filtering to problems solved in:
    </p>

    <p style="display: none" id="date-filter">
        Filtering to problems solved on:
    </p>

    <p style="display: none" id="see-all">
      <a href="/" class="link"> See all</a>
    </p>

    <table id="problemTable" class="problem-table" cellpadding="10">
      <tr>
        <th>Problem</th>
        <th>Difficulty</th>
        <th>Date solved</th>
        <th>Language</th>
        <th>Tags</th>
      </tr>
    </table>
  </div>
</div>

<p class="bottom-text">
  Â© 2024-20XX
  <a href="https://benrosenberg.info" class="link">Ben Rosenberg</a>
</p>

<script>
  async function retrieveData() {
    const response = await fetch(
      "https://68b329da9893e34099c7d8ad5cb9c940.xn--6frz82g/static/leetcode-solutions.json"
    );
    const data = await response.json();
    // console.log(data);
    return data;
  }

  function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
  }

  function notFound(problemID) {
    const url = new URL(window.location.href);
    window.location = url.origin + "/404.html";
  }

  function goToProblem(problemID) {
    const url = new URL(window.location.href + "/problem.html");
    url.searchParams.set("problem", problemID);
    window.location = url;
  }

  function goToTag(tag) {
    const url = new URL(window.location.href);
    url.searchParams.set("tag", tag);
    window.location = url;
  }

  function goToDifficulty(difficulty) {
    const url = new URL(window.location.href);
    url.searchParams.set("difficulty", difficulty);
    window.location = url;
  }

  function goToLanguage(language) {
    const url = new URL(window.location.href);
    url.searchParams.set("language", language);
    window.location = url;
  }

  function goToDate(date) {
    const url = new URL(window.location.href);
    url.searchParams.set("date", date);
    window.location = url;
  }

  function getProblemTitleLink(problemData) {
    return `<a class="table-link" onclick="goToProblem(${problemData.number})">${problemData.number}. ${problemData.title}</a>`;
  }

  function populateProblemTable(data) {
    var table = document.getElementById("problemTable");
    var keys = Object.keys(data);
    keys.sort((a, b) => a.localeCompare(b, undefined, { numeric: true }));
    keys.forEach((key) => {
      table.innerHTML += createTableRow(data[key]);
    });
  }

  function createTableRow(problemData) {
    var tagCell = "";
    var numTagsToShow = 3;
    var tagsToShow = problemData.tags.slice(0, numTagsToShow);
    tagsToShow.forEach((tag, tagIndex) => {
      if (tagIndex < problemData.tags.length - 1) {
        tagCell += `<a class="table-link" onclick="goToTag('${tag}')">${tag}</a>, `;
      } else {
        tagCell += `<a class="table-link" onclick="goToTag('${tag}')">${tag}</a>`;
      }
    });
    if (problemData.tags.length > numTagsToShow) {
      tagCell += "...";
    }

    return (
      "<tr>" +
      "<td>" +
      getProblemTitleLink(problemData) +
      "</td>" +
      `<td><a onclick="goToDifficulty('${
        problemData.difficulty
      }')"><span class="difficulty ${
        problemData.difficulty
      }">${capitalizeFirstLetter(problemData.difficulty)}</span></a></td>` +
      `<td><a onclick="goToDate('${problemData.date}')">${problemData.date}</a></td>` +
      `<td><a class="table-link" onclick="goToLanguage('${
        problemData.language
      }')">${capitalizeFirstLetter(problemData.language)}</a></td>` +
      "<td>" +
      tagCell +
      "</td>" +
      "</tr>"
    );
  }

  function filterToTag(tag, data) {
    const newData = [];
    Object.keys(data).forEach((key) => {
      if (data[key].tags.includes(tag)) {
        newData.push(data[key]);
      }
    });
    return newData;
  }

  function filterToDifficulty(difficulty, data) {
    const newData = [];
    Object.keys(data).forEach((key) => {
      if (data[key].difficulty == difficulty) {
        newData.push(data[key]);
      }
    });
    return newData;
  }

  function filterToLanguage(language, data) {
    const newData = [];
    Object.keys(data).forEach((key) => {
      if (data[key].language == language) {
        newData.push(data[key]);
      }
    });
    return newData;
  }

  function filterToDate(date, data) {
    const newData = [];
    Object.keys(data).forEach((key) => {
      if (data[key].date == date) {
        newData.push(data[key]);
      }
    });
    return newData;
  }

  function markAsFilteredToTag(tag) {
    var filterText = document.getElementById("tag-filter");
    filterText.style.display = "block";
    filterText.innerText += " " + tag;
  }

  function markAsFilteredToDifficulty(difficulty) {
    var filterText = document.getElementById("difficulty-filter");
    filterText.style.display = "block";
    filterText.innerHTML +=
      " " +
      `<span class="difficulty ${difficulty}">${capitalizeFirstLetter(
        difficulty
      )}</span>`;
  }

  function markAsFilteredToLanguage(language) {
    var filterText = document.getElementById("language-filter");
    filterText.style.display = "block";
    filterText.innerText += " " + capitalizeFirstLetter(language);
  }

  function markAsFilteredToDate(date) {
    var filterText = document.getElementById("date-filter");
    filterText.style.display = "block";
    filterText.innerText += " " + date;
  }

  function markAsFiltered() {
    var filterText = document.getElementById("see-all");
    filterText.style.display = "initial";
  }

  function setTotalSolved(data) {
    var totalElement = document.getElementById("total-solved");
    totalElement.innerText += " " + Object.keys(data).length;
  }

  function setLastSolved(data) {
    var lastSolvedElement = document.getElementById("last-solved");
    var maxDate = "2000-1-1";
    Object.keys(data).forEach((key) => {
      if (data[key]["date"] > maxDate) {
        maxDate = data[key]["date"];
      }
    });
    lastSolvedElement.innerText += " " + maxDate;
  }

  retrieveData().then((data) => {
    const url = new URL(window.location.href);
    const tag = url.searchParams.get("tag");
    var filtered = false;
    var dataToUse = data;
    if (tag != null) {
      dataToUse = filterToTag(tag, dataToUse);
      markAsFilteredToTag(tag);
      filtered = true;
    }

    const difficulty = url.searchParams.get("difficulty");
    if (difficulty != null) {
      dataToUse = filterToDifficulty(difficulty, dataToUse);
      markAsFilteredToDifficulty(difficulty);
      filtered = true;
    }

    const language = url.searchParams.get("language");
    if (language != null) {
      dataToUse = filterToLanguage(language, dataToUse);
      markAsFilteredToLanguage(language);
      filtered = true;
    }

    const date = url.searchParams.get("date");
    if (date != null) {
      dataToUse = filterToDate(date, dataToUse);
      markAsFilteredToDate(date);
      filtered = true;
    }

    if (filtered) {
      markAsFiltered();
    }

    setTotalSolved(dataToUse);

    setLastSolved(dataToUse);

    populateProblemTable(dataToUse);
  });
</script>

<script src="theme.js"></script>
